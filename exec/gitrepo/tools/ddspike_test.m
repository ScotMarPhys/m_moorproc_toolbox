% test ddspikex = rand(1,2000);x([1 10 11 200 1400 1500 1700 1900 2000]) = [-400 2000 NaN -20  -2000 -100 200 20 +400];[yd,dx,ndx] = ddspike(x,[-800 800],10,6,'y',800);