function jd = julian(yy,mm,dd,hh)%JULIAN Convert Gregorian date to Julian day.%  JD = JULIAN(YY,MM,DD,HH) or JD = JULIAN([YY,MM,DD,HH]) returns the Julian%  day number of the calendar date specified by year, month, day, and decimal%  hour.%%  JD = JULIAN(YY,MM,DD) or JD = JULIAN([YY,MM,DD]) if decimal hour is absent,%  it is assumed to be zero.%%  Although the formal definition holds that Julian days start and end at%  noon, here Julian days start and end at midnight. In this convention,%  Julian day 2440000 began at 00:00 hours, May 23, 1968.%%  See also GREGORIAN.%  Christian Mertens, IfM Kiel%  $Revision: 1.1 $ $Date: 1998/08/31 14:02:08 $m = size(yy);if nargin == 1  if m(2) > 3    hh = yy(:,4);  else    m(2) = 1;    hh = zeros(m);  end  dd = yy(:,3);  mm = yy(:,2);  yy = yy(:,1);elseif nargin == 3  hh = zeros(m);endif any(yy == 0)  error('There is no year zero.')endi = yy < 0;yy(i) = yy(i) + 1;igreg = dd + 31*(mm + 12*yy) >= 15 + 31*(10 + 12*1582);i = mm <= 2;mm = mm + 1;yy(i) = yy(i) - 1;mm(i) = mm(i) + 12;jd = floor(365.25*yy) + floor(30.6001*mm) + dd + 1720995;ja = floor(0.01*yy(igreg));jd(igreg) = jd(igreg) + 2 - ja + floor(0.25*ja);jd = jd + hh/24;