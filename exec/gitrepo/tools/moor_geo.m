% geostrophic transport from move mooringcleardata_path = '/data-so1/kanzow/move_kanzow/atalante_kanzow/mat_data/';figure(3)  subplot(2,1,1)  hold off  subplot(2,1,2)   hold offfigure(8)  hold off%moorl  = ['V406_1';'V406_1';'V405_1';];%moorr  = ['V404_1';'V405_1';'V404_1';]; moorl  = ['v406_2';'v406_2';'v405_2';];moorr  = ['v404_2';'v405_2';'v404_2';]; pmax  = 5000; %obergrenzepmin  = 1100; %untergrenzela1   = 16;la2   = 16;pr    = 5000;  % referenzdruckref_year = 2001; % reference year of experiment cl    = 'brg'; % colors for printingfor mo = 1:3,  moor1 = moorl(mo,:);  moor2 = moorr(mo,:);  eval(['load ',data_path,moor1,'_moor2d.mat'])  s1 = SSS;  t1 = TTT;  eval(['load ',data_path,moor2,'_moor2d.mat'])  s2 = SSS;  t2 = TTT;   ii = find(p<=pmax & p>=pmin);  if strcmp(moor1,'V404_1') |strcmp(moor1,'v404_2')        lo1 = -51.5;  elseif strcmp(moor1,'V405_1')|strcmp(moor1,'v405_2')        lo1 = -57;  elseif strcmp(moor1,'V406_1')|strcmp(moor1,'v406_2')        lo1 = -60.5;  end  if strcmp(moor2,'V404_1')|strcmp(moor2,'v404_2')        lo2 = -51.5;  elseif strcmp(moor2,'V405_1')|strcmp(moor2,'v405_2')        lo2 = -57;  elseif strcmp(moor2,'V406_1')|strcmp(moor2,'v406_2')        lo2 = -60.5;  end  [ct,p_ct] = ge_tr(flipud(p(ii)'),flipud(t1(ii,:)),flipud(s1(ii,:)),la1,...              flipud(p(ii)'),flipud(t2(ii,:)),flipud(s2(ii,:)),la2,pr);  [v,p_v]   = ge_ve(flipud(p(ii)'),flipud(t1(ii,:)),flipud(s1(ii,:)),la1,lo1,...              flipud(p(ii)'),flipud(t2(ii,:)),flipud(s2(ii,:)),la2,lo2,pr);  eval(['ct',num2str(mo),' = ct;'])  eval(['v',num2str(mo),' = v;'])    day = jd_grid - julian(ref_year,1,1,0);if 1  figure(3)  subplot(2,1,1)  plot(day,ct(size(ct,1),:),cl(mo),'Linewidth',2)    hold on  drawnow   vm = meanmiss(v')'*100;  vs = stdmiss(v')'*100;  subplot(2,1,2)  plot(vm,p_v,cl(mo),'Linewidth',2)    hold on  plot(vm+vs,p_v,[cl(mo),'--'],'Linewidth',2)     plot(vm-vs,p_v,[cl(mo),'--'],'Linewidth',2)        drawnow    end % end if 0 figure(8)  if strcmp('V404_1',moor1) | strcmp('V404_1',moor2)     ct(size(ct,1),[1:7 31:47]) = NaN;  end  if mo == 2    ct(size(ct,1),[1:10 ]) = NaN;  end  plot(day,ct(size(ct,1),:)-meannan(ct(size(ct,1),:)),cl(mo),'LineWidth',2)    hold on  drawnow   if 1 figure(4)  subplot(3,1,mo)  hold off  [c,h] = contourf(day,p_v(:,1),v*100,[-20:.5:20]);  set(h,'LineWidth',.2)  hold on   [c,h] = contour(day,p_v(:,1),v*100,[0 0]);  set(h,'EdgeColor','w')  set(h,'LineWidth',1)     dayaxis(day,2000,[1])  set(gca,'Ydir','Reverse')   yl = ylabel('velocity [cm/s]');  ti = title(['dynamic height velocity rel. ',num2str(pmax),' dbar    moorings: ',moor1,' / ',moor2]);   set(yl,'FontSize',12)  set(ti,'FontSize',12)    caxis([-5.8 1])  colorbar  end % end if 0 end  % end mo-loop if 1  figure(3)   subplot(2,1,1)  set(gca,'XGrid','on')  set(gca,'YGrid','on')        dayaxis(day,2000,[1])  leg= legend('M1/M3','M2/M3','M1/M2',1);  subplot(2,1,1)  yl = ylabel([num2str(pmin),' - ',num2str(pmax),' dbar  transport [Sv]']);  set(yl,'FontSize',12)  ti=title(['dynamic height transport rel. ',num2str(pmax), 'dbar']);    set(ti,'FontSize',12)  set(gca,'XLim',[30 365])   set(gca,'YLim',[-45 25])  set(gca,'FontSize',12)   set(leg,'FontSize',12)     figure(3)   subplot(2,1,2)   set(gca,'YDir','Reverse')   set(gca,'XGrid','on')   set(gca,'YGrid','on')         yl = ylabel('pressure [dbar]');   xl = xlabel('velocity [cm/s]');   ti = title('mean dynamic height velocity rel. 5000 dbar (and standard deviation)');      set(yl,'FontSize',12)   set(xl,'FontSize',12)   set(ti,'FontSize',12)   set(gca,'Ylim',[pmin-100 pmax+100])   set(gca,'XLim',[-4.5 .5])   set(gca,'FontSize',12)   orient tall    print -dpsc moor_geo1.psc   %  print -depsc moor_geo1.epsc    figure(4)  orient tall  print -dpsc  moor_geo2.psc %  print -depsc  moor_geo2.epsc end % end if 0  figure(8)   set(gca,'XGrid','on')  set(gca,'YGrid','on')        dayaxis(day,2000,[1])  leg= legend('M1/M3 - whole section ','M2/M3 - west gate','M1/M2 - east gate',4);  yl = ylabel([num2str(pmin),' - ',num2str(pmax),' dbar  transport [Sv]']);  set(yl,'FontSize',12)  ti=title(['dynamic height transport fluctuations rel. ',num2str(pr), 'dbar']);    set(ti,'FontSize',12)  set(gca,'XLim',[30 365])   set(gca,'YLim',[-20 20 ])  set(gca,'FontSize',12)   set(leg,'FontSize',12)    print -dpsc  moor_geo3.psc %  print -depsc  moor_geo3.epsc   eval(['save ',data_path,'moor_geo.mat ct1 ct2 ct3 v1 v2 v3 day p_ct p_v'])