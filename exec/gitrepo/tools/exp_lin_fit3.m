% exponential linear fit: yfit = a1*(1-exp(-a2*(x-x(1)))) + a3*(x-x(1)) + a4% of some function y = y(x) using gaussian method%% returns coefficients of model a = [a(1) a(2) a(3) a(4)];%% function [a,yfit] = exp_lin_fit3(x,y,[a])%% input   y    -- function to which fit will be applied %         x    -- y = y(x);%         a    -- a = [a1 a2 a3 a4] first guess %                 for coefficients of fit, default = [0 0 0 0]%% output  a    -- a = [a(1) a(2) a(3) a(4)]: coefficients of fit %         yfit -- yfit = a1*exp( (x-x(1))/a2 ) + a3*(x-mean(x)) + a4%%  for more help, see build-in function 'nlinfit.m'%% uses: exp_lin_fun3.m%% T.Kanzow 10.4.00% Z Szuts  17.11.08: NB difference in definition of a3 and a4 with exp_lin_fit2.mfunction [a,yfit] = exp_lin_fit3(x,y,a)% --- Model ----------- funca = 'exp_lin_fun3';% --- default input values --------if nargin < 3  a1 = 0; a2 = 0;  a3 = 0;  a4 = 0; else   if isempty(a)     a = zeros(1,4);  else     a1 = a(1);    a2 = a(2);    a3 = a(3);    a4 = a(3);  endend % ---  simplex - least square fit ----a    = nlinfit_old(x,y,funca,[a1 a2 a3 a4]);yfit = exp_lin_fun3(a,x); 