% PIES Travel Time Processing% a) data is smoothed by calculating hourly medians of each of the channels% b) hourly median from the channel% c) data is low-pass filtered  % -- parameters --moor = 'v406_4';sr   = 6*24;co   = 1/2;outfile = [moor,'_TT.mat'];% -- load data ----if strcmp(moor,'v406_4')  load /data-so5/move_kanzow/me60_kanzow/mat_data/012_0.mat  lim =[6.64 6.7];  % basis despiking  002_21  good = 1:33936;     % cut off time jump near endelseif strcmp(moor,'v404_3')  load /data0-led/move_kanzow/so172_kanzow/mat_data/002_21.mat  lim =[6.578 6.59];  % basis despiking  002_21  good = 1:72678;     % cut off time jump near endelseif strcmp(moor,'v405_3')  load /data0-led/move_kanzow/so172_kanzow/mat_data/001_8.mat  lim = [6.602 6.61]; % basis despiking  001_8  good = 0;elseif strcmp(moor,'v406_3')  load /data0-led/move_kanzow/so172_kanzow/mat_data/012_4.mat  lim =[6.522 6.53];  % basis despiking  012_4  good = 7:72648;    % cut off time jump near beginningend% --- process data ----disp('processing data - might take some time ...')if length(good) > 1  %%TT = interp1(jd(good),TT(good,:), jd(good(1)):1/24/60:jd(good(end)));  %%jd = jd(good(1)):1/24/60:jd(good(end));  TT = TT(good,:);  jd = jd(good,:); end[m,n]    = size(TT);limI     = find(TT>lim(2) | TT<lim(1));TT(limI) = NaN;tm1 = medianmiss(reshape(TT(:,1),6,m/6)); %median sinlge ping hourly valuestm2 = medianmiss(reshape(TT(:,2),6,m/6));tm3 = medianmiss(reshape(TT(:,3),6,m/6));tm4 = medianmiss(reshape(TT(:,4),6,m/6));%%keyboardjd  = jd(3:6:end);tm       = medianmiss([tm1;tm2;tm3;tm4]); %median of 4 ping hourly mediansinan     = find(isnan(tm));tm(inan) = meannan(tm);tmf = auto_filt(tm,sr,co);%%[Pf,F] = spectrum(tmf,3000,0,[],6*24);%%[P,F] = spectrum(tm,3000,0,[],6*24);% --- save data -------eval(['save ',outfile,' tm tmf jd ;'])